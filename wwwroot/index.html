<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Internship Application Manager</title>
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css' rel='stylesheet' />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href="styles.css" rel="stylesheet" />
  <style>
    html {
      overflow-y: scroll !important;
    }
    body {
      overflow-y: auto !important;
    }
    
    /* Body scroll lock for modals */
    body.scroll-locked {
      overflow: hidden !important;
      position: fixed !important;
      width: 100% !important;
      height: 100% !important;
    }
  </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script>
      // Initialize EmailJS
      (function() {
        emailjs.init("X80istNGO-VJ1Q9zZ");
      })();
    </script>
    <style>
      /* Help Modal Styles */
      .help-modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
        animation: fadeIn 0.3s ease-out;
      }
      
      .help-content {
        background-color: #fff;
        margin: 5% auto;
        padding: 20px;
        border-radius: 12px;
        width: 80%;
        max-width: 600px;
        max-height: 80vh;
        overflow-y: auto;
        position: relative;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      }
      
      .help-close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
        position: absolute;
        top: 10px;
        right: 15px;
      }
      
      .help-close:hover {
        color: #000;
      }
      
      .help-section {
        margin-bottom: 20px;
      }
      
      .help-section h3 {
        color: #1e293b;
        margin-bottom: 10px;
        font-size: 16px;
      }
      
      .help-section p {
        color: #475569;
        line-height: 1.6;
        margin-bottom: 10px;
      }
      
      .help-section ul {
        color: #475569;
        line-height: 1.6;
        padding-left: 20px;
      }
      
      .help-section li {
        margin-bottom: 8px;
      }
      
      .status-badge {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 500;
        margin-right: 8px;
      }
      
      .status-interested { background: #fef3c7; color: #92400e; }
      .status-applied { background: #dbeafe; color: #1e40af; }
      .status-phone_screen { background: #e0e7ff; color: #3730a3; }
      .status-interview { background: #f3e8ff; color: #7c3aed; }
      .status-offer { background: #d1fae5; color: #065f46; }
      .status-rejected { background: #fee2e2; color: #991b1b; }
      
      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }
      
      /* Help Button Styles */
      .help-btn {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        border: 2px solid #3b82f6;
        background: #3b82f6;
        color: white;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
        position: absolute;
        top: 20px;
        left: 20px;
        z-index: 1001;
      }
      
      .help-btn:hover {
        background: #2563eb;
        border-color: #2563eb;
        transform: scale(1.1);
      }
    </style>
  </head>
  <body>
    <!-- Redirect to login if not authenticated -->
    <script>
      // Check if user is logged in (in a real app, this would check localStorage or cookies)
      if (!localStorage.getItem('userLoggedIn')) {
        window.location.href = 'login.html';
      }
    </script>
    
    <!-- Header -->
    <div class="header-rect">
      <div class="header-inner" style="display: flex !important; justify-content: space-between !important; align-items: center !important;">
        <div>
          <div class="brand" onclick="window.location.href='index.html'" style="cursor: pointer;">Internship Application Manager</div>
          <div class="subtitle">Track your internship applications and manage your career journey</div>
        </div>
        <div class="auth-buttons">
          <button class="btn btn-sm" onclick="logout()" style="position: absolute; top: 20px; right: 20px; z-index: 1001;">Logout</button>
        </div>
      </div>
    </div>

    <!-- Navigation -->
    <div class="nav-banner-rect">
      <div class="nav-banner-inner">
        <button class="nav-btn active" onclick="window.location.href='index.html'">ðŸ“Š Dashboard</button>
        <button class="nav-btn" onclick="window.location.href='resumes.html'">ðŸ“„ Resumes</button>
        <button class="nav-btn" onclick="window.location.href='calendar.html'">ðŸ“… Calendar</button>
        <button class="nav-btn" onclick="window.location.href='ai.html'">ðŸ¤– AI Assistant</button>
      </div>
    </div>

    <main class="container">
      <div class="panel full-width" style="margin-top: 20px; display: flex; gap: 20px;">
        
        <div class="card" style="flex: 0 0 300px; max-height: fit-content; height: fit-content;">
          <!-- Add Job Posting Section -->
          <div class="form-section" style="background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%); border-radius: 12px; padding: 20px; margin-bottom: 20px; border: 1px solid #e2e8f0;">
            <h3 style="margin-top: 0; color: #1e293b; font-size: 18px; font-weight: 600;">Add Job Posting</h3>
            <form id="postingForm" class="form-vertical">
              <!-- Add spacing above job title -->
              <div style="margin-top: 70px;">
                <input name="title" placeholder="Job Title" required />
                <input name="company" placeholder="Company Name" />
                <textarea name="description" placeholder="Job description" rows="4" style="resize: none;"></textarea>
                <input name="due_date" type="date" />
                <select name="status">
                  <option value="interested">Interested</option>
                  <option value="applied">Applied</option>
                  <option value="phone_screen">Phone Screen</option>
                  <option value="interview">Interview</option>
                  <option value="offer">Offer</option>
                  <option value="rejected">Rejected</option>
                </select>
              </div>
              
            <!-- Email Notification Settings -->
            <div style="border-top: 1px solid #e2e8f0; padding-top: 3px; margin-top: 3px;">
              <h4 style="margin: 0 0 10px 0; color: #1e293b; font-size: 14px; font-weight: 600;">ðŸ“§ Email Notifications</h4>
              <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 10px; font-size: 13px; cursor: pointer;">
                <input type="checkbox" name="emailNotifications" id="emailNotifications" onchange="toggleEmailFields()" style="width: 16px; height: 16px; accent-color: #3b82f6; margin: 0; vertical-align: middle;">
                <span style="line-height: 16px; vertical-align: middle;">Send email reminders for this posting</span>
              </label>
              <div id="emailFields" style="height: 120px; opacity: 0; transition: opacity 0.3s ease;">
                <input type="email" name="notificationEmail" id="notificationEmail" placeholder="Email for notifications" style="font-size: 13px; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; margin-bottom: 10px;">
                <select name="notificationTiming" id="notificationTiming" style="font-size: 13px; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; width: 100%;">
                  <option value="1_day">1 day before due date</option>
                  <option value="3_days">3 days before due date</option>
                  <option value="1_week">1 week before due date</option>
                  <option value="2_weeks">2 weeks before due date</option>
                  <option value="on_due_date">On due date</option>
                </select>
              </div>
            </div>
              
              <button class="btn primary">Add Posting</button>
            </form>
          </div>
          
          <!-- Analytics Dashboard Section -->
          <div class="analytics-section" style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border-radius: 12px; padding: 20px; border: 1px solid #e2e8f0;">
            <h3 style="margin-top: 0; color: #1e293b; font-size: 18px; font-weight: 600;">ðŸ“Š Application Analytics</h3>
            <div style="display: flex; flex-direction: column; gap: 20px;">
              <!-- Status Distribution Chart -->
              <div style="height: 200px;">
                <canvas id="statusChart"></canvas>
              </div>
              <!-- Quick Stats -->
              <div id="quickStats" class="analytics-stats">
                <div class="stat-item">
                  <span class="stat-label">Total Applications:</span>
                  <span class="stat-value" id="totalApplications">0</span>
                </div>
                <div class="stat-item">
                  <span class="stat-label">Success Rate:</span>
                  <span class="stat-value" id="successRate">0%</span>
                </div>
              </div>
            </div>
          </div>
          
        </div>

        <div class="card" style="flex: 1;">
          <div class="postings-header">
            <h3>Job Postings</h3>
            <div class="search-filter-controls">
              <input type="text" id="searchInput" placeholder="Search postings..." class="search-input" />
              <select id="statusFilter">
                <option value="">All Statuses</option>
                <option value="interested">Interested</option>
                <option value="applied">Applied</option>
                <option value="phone_screen">Phone Screen</option>
                <option value="interview">Interview</option>
                <option value="offer">Offer</option>
                <option value="rejected">Rejected</option>
              </select>
              <button id="exportPostings" class="btn btn-sm">ðŸ“Š Export</button>
            </div>
          </div>
          <div id="postings" class="list"></div>
        </div>
      </div>
    </main>


    <!-- Help Button -->
    <button id="helpBtn" class="help-btn" title="Help & Tips">?</button>

    <!-- Edit Job Posting Modal -->
    <div id="editModal" class="modal" style="display: none;">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Edit Job Posting</h2>
          <button id="closeEditModal" onclick="closeEditModal()" style="
            background: #ef4444 !important;
            border: none !important;
            color: white !important;
            cursor: pointer !important;
            padding: 8px 12px !important;
            border-radius: 6px;
            font-size: 16px !important;
            position: relative !important;
            z-index: 9999 !important;
            min-width: 32px !important;
            min-height: 32px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            flex-shrink: 0 !important;
            user-select: none !important;
            margin: 0 !important;
          ">&times;</button>
        </div>
        <div class="modal-body">
          <form id="editForm" class="form-vertical">
            <input type="hidden" id="editPostingId" name="id">
            
             <!-- Add spacing above job title -->
             <div style="margin-top: 70px;">
               <input id="editTitle" name="title" placeholder="Job Title" required />
              <input id="editCompany" name="company" placeholder="Company Name" />
              <textarea id="editDescription" name="description" placeholder="Job description" rows="4" style="resize: none;"></textarea>
              <input id="editDueDate" name="due_date" type="date" />
              <select id="editStatus" name="status">
                <option value="interested">Interested</option>
                <option value="applied">Applied</option>
                <option value="phone_screen">Phone Screen</option>
                <option value="interview">Interview</option>
                <option value="offer">Offer</option>
                <option value="rejected">Rejected</option>
              </select>
            </div>
            
            <!-- Email Notification Settings -->
            <div style="border-top: 1px solid #e2e8f0; padding-top: 3px; margin-top: 3px;">
              <h4 style="margin: 0 0 10px 0; color: #1e293b; font-size: 14px; font-weight: 600;">ðŸ“§ Email Notifications</h4>
              <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 10px; font-size: 13px; cursor: pointer;">
                <input type="checkbox" id="editEmailNotifications" name="emailNotifications" onchange="toggleEditEmailFields()" style="width: 16px; height: 16px; accent-color: #3b82f6; margin: 0; vertical-align: middle;">
                <span style="line-height: 16px; vertical-align: middle;">Send email reminders for this posting</span>
              </label>
              <div id="editEmailFields" style="height: 120px; opacity: 0; transition: opacity 0.3s ease;">
                <input type="email" id="editNotificationEmail" name="notificationEmail" placeholder="Email for notifications" style="font-size: 13px; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; margin-bottom: 10px;">
                <select id="editNotificationTiming" name="notificationTiming" style="font-size: 13px; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; width: 100%;">
                  <option value="1_day">1 day before due date</option>
                  <option value="3_days">3 days before due date</option>
                  <option value="1_week">1 week before due date</option>
                  <option value="2_weeks">2 weeks before due date</option>
                  <option value="on_due_date">On due date</option>
                </select>
              </div>
            </div>
            
            <div class="modal-actions">
              <button type="button" id="cancelEdit" class="btn">Cancel</button>
              <button type="submit" class="btn primary">Update Posting</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="help-modal" style="display: none;">
      <div class="help-content">
        <span id="closeHelpModal" class="help-close">&times;</span>
        <h2>Welcome to Internship Application Manager!</h2>
        <div class="help-section">
          <h3>ðŸŽ¯ About This Platform</h3>
          <p>Internship Application Manager is your all-in-one solution for tracking internship applications, managing your career journey, and staying organized throughout the application process. Whether you're applying to your first internship or managing multiple opportunities, this platform helps you stay on top of deadlines, track your progress, and make data-driven decisions about your career.</p>
        </div>
        <div class="help-section">
          <h3>ðŸ“‹ Getting Started</h3>
          <p>This tool helps you track your internship applications. Here's how to use it:</p>
          <ul>
            <li><strong>Add Job Postings:</strong> Use the form on the left to add new internship opportunities</li>
            <li><strong>Track Status:</strong> Update the status of your applications as you progress</li>
            <li><strong>View Analytics:</strong> See charts showing your application progress</li>
            <li><strong>Search & Filter:</strong> Use the search bar and status filter to find specific applications</li>
          </ul>
        </div>
        <div class="help-section">
          <h3>ðŸ“Š Application Statuses</h3>
          <ul>
            <li><span class="status-badge status-interested">Interested</span> - You're considering applying</li>
            <li><span class="status-badge status-applied">Applied</span> - Application submitted</li>
            <li><span class="status-badge status-phone_screen">Phone Screen</span> - Initial screening call</li>
            <li><span class="status-badge status-interview">Interview</span> - Formal interview scheduled</li>
            <li><span class="status-badge status-offer">Offer</span> - Job offer received</li>
            <li><span class="status-badge status-rejected">Rejected</span> - Application not successful</li>
          </ul>
        </div>
        <div class="help-section">
          <h3>ðŸ’¡ Tips for Success</h3>
          <ul>
            <li>Keep your applications organized by updating statuses regularly</li>
            <li>Use the calendar to track important dates and deadlines</li>
            <li>Upload your resumes to keep them organized and easily accessible</li>
            <li>Use the AI assistant for help with applications and interview prep</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Hidden Pages -->
    <div id="resumesPage" class="page" style="display: none;">
      <iframe src="resumes.html" width="100%" height="800px" frameborder="0"></iframe>
    </div>

    <div id="calendarPage" class="page" style="display: none;">
      <iframe src="calendar.html" width="100%" height="800px" frameborder="0"></iframe>
    </div>

    <div id="aiPage" class="page" style="display: none;">
      <iframe src="ai.html" width="100%" height="800px" frameborder="0"></iframe>
    </div>

    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.js'></script>
    <script src="main.js?v=35"></script>
    
    <!-- Help Modal JavaScript -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const helpBtn = document.getElementById('helpBtn');
        const helpModal = document.getElementById('helpModal');
        const closeHelpModal = document.getElementById('closeHelpModal');
        
        if (helpBtn && helpModal && closeHelpModal) {
          helpBtn.addEventListener('click', function() {
            helpModal.style.display = 'block';
          });
          
          closeHelpModal.addEventListener('click', function() {
            helpModal.style.display = 'none';
          });
          
          // Close modal when clicking outside
          helpModal.addEventListener('click', function(e) {
            if (e.target === helpModal) {
              helpModal.style.display = 'none';
            }
          });
        }
      });
    </script>
    
    <!-- Authentication Functions -->
    <script>
      function logout() {
        localStorage.removeItem('userLoggedIn');
        window.location.href = 'login.html';
      }
    </script>
  </body>
</html>